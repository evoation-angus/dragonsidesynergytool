<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="DataTables-1.11.3/css/jquery.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="stylesheet.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>


    <title>Document</title>
</head>

<body>
    <header>
        <div class="container-fluid">
            <div class="row border-primary p-5 mb-2 bg-info text-white"
                style="background-image: url(images/hexandchemDragons3.jpg); background-position: center 33%;">
                <h1 style="text-shadow: 2px 2px 4px black; ">Dragonside Synergy Tool</h1>
            </div>
        </div>
    </header>
    <div class="container-fluid mt-3">
        <div class="row">
            <div class="col-6 border border-primary">
                <div class="row">
                    <div class="col">
                        <h3>ADC</h3>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h4>Common ADCs:</h4>
                        <div class="row row-cols-3 row-cols-xs-2 row-cols-sm-3 row-cols-md-5">
                            <div class="col-sm">
                                <img src="images/Aphelios.png" alt="" class="img-fluid champImg"
                                    onclick="championSelect(this)" id="523">
                                <p>Aphelios</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Ashe.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="22">
                                <p>Ashe</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Caitlyn.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="51">
                                <p>Caitlyn</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Draven.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="119">
                                <p>Draven</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Ezreal.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="81">
                                <p>Ezreal</p>
                            </div>


                            <div class="col-sm">
                                <img src="images/Jhin.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="202">
                                <p>Jhin</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Jinx.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="222">
                                <p>Jinx</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Kaisa.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="145">
                                <p>Kai'Sa</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Kalista.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="429">
                                <p>Kalista</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Kindred.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="203">
                                <p>Kindred</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/KogMaw.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="96">
                                <p>Kog'Maw</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Lucian.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="236">
                                <p>Lucian</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/MissFortune.png" alt="" class="img-fluid"
                                    onclick="championSelect(this)" id="21">
                                <p>Miss Fortune</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Samira.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="360">
                                <p>Samira</p>
                            </div>
                            <div class="col-sm">
                                <img src="images/Twitch.png" alt="" class="img-fluid" onclick="championSelect(this)"
                                    id="29">
                                <p>Twitch</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion" id="accordionExample">
                    <div class="card">
                        <div class="card-header" id="headingOne">
                            <h2 class="mb-0">
                                <button class="btn btn-block" type="button" data-toggle="collapse"
                                    data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    Off Meta ADCs
                                </button>
                            </h2>
                        </div>
                        <div id="collapseOne" class="collapse" aria-labelledby="headingOne"
                            data-parent="#accordionExample">
                            <div class="card-body">
                                <div class="col mx-auto">
                                    <div id="champList" class="row row-cols-2 row-cols-sm-4 row-cols-md-5">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-6 border border-primary">
                <div class="row row-cols-3">
                    <div class="col"></div>
                    <div class="col">
                        <h3>Support</h3>
                    </div>
                    <div class="col"></div>
                </div>
                <table class="table" id="supportTable">
                    <thead>
                        <tr>
                            <th scope="col">Name</th>
                            <th scope="col">Games</th>
                            <th scope="col">Win Rate</th>
                        </tr>
                    </thead>
                    <tbody id="supports">

                    </tbody>
                </table>
            </div>
        </div>


        <script>
            document.onload = getADCnames();
            var championIDtable = [];
            var table
            var counter = 0;


            function setTable() {
                if (counter >= 1) {
                    table.destroy();
                }

                table = $('#supportTable').DataTable({
                    ajax: {
                        type: "GET",
                        url: "http://dragonsidesynergy-env.eba-rfrgjick.ap-southeast-2.elasticbeanstalk.com/currentadc",
                        dataSrc: "supports",
                    },
                    columns: [
                        { "data": "name" },
                        {
                            "data": "occurences"

                        },
                        {
                            data: null,
                            render: function (data, type, row) {
                                return Math.round((row.wins / row.occurences) * 100) + "%";
                            }
                        }
                    ],
                    order: [[1, "desc"]],
                    rowReorder: {
                        selector: 'td:nth-child(2)'
                    },
                    responsive: true

                });

                counter++;
                filterRows();
            };
            function filterRows() {
                var indexes = table
                    .rows()
                    .indexes()
                    .filter(function (value, index) {
                        return 'Leona' === table.row(value).data()[0];
                    });

                table.rows(indexes).remove().draw();
            }

            var previousElement = null;
            function championSelect(element) {
                if (previousElement != null) {
                    previousElement.style.boxShadow = "none";
                }
                previousElement = element;
                var name = element.innerHTML;
                //var iconurl = "https://ddragon.leagueoflegends.com/cdn/11.22.1/img/champion/" + name + ".png";
                //document.getElementById("adc").innerHTML = name;
                //document.getElementById("adcIcon").src = iconurl;
                console.log(name);
                var id = element.id;
                element.style.boxShadow = "0 0 0 3px red";
                sendADCID(id);
                //document.getElementById("supports").innerHTML = championIDtable[id];
            }

            function sendADCID(id) {
                var info = { ChampID: id };
                $.ajax({
                    type: "POST",
                    url: "http://dragonsidesynergy-env.eba-rfrgjick.ap-southeast-2.elasticbeanstalk.com/adcid",
                    data: JSON.stringify(info),
                    contentType: "application/json;",
                    success: function (data) {
                        console.log("Finished sending ID")
                        setTable()
                    }
                })
                console.log("Starting to get ADC")

            }

            function getADC() {
                $.ajax({

                    type: "GET",
                    url: "http://dragonsidesynergy-env.eba-rfrgjick.ap-southeast-2.elasticbeanstalk.com/currentadc",
                    success: function (data) {
                        var response = JSON.parse(data);
                        var supports = response.supports;
                        var json = '{"data" : ';
                        json += JSON.stringify(supports) + "}";
                        console.log(json);


                        /*console.log("Finished to get ADC")
                        var response = JSON.parse(data);
                        console.log(data);
                        var supports = response.supports;
                        console.log(supports);
                        var output = "";
                        for (var i = 0; i < supports.length; i++) {
                            let winRate = Math.round((supports[i].wins / supports[i].occurences) * 100);
                            output += '<tr>' + "<td>" + supports[i].name + '</td> <td>' + supports[i].occurences + "</td> <td> " + winRate + "%" + '</td> </tr>';
                        }
                        document.getElementById("supports").innerHTML = output;
                        tableSetup() */
                    }
                })
            }

            function getADCnames() {
                $.ajax({
                    type: "GET",
                    url: "http://dragonsidesynergy-env.eba-rfrgjick.ap-southeast-2.elasticbeanstalk.com/adcnames",
                    success: function (data) {
                        console.log(data);
                        var response = JSON.parse(data);
                        var adcs = response;
                        var output = "";
                        for (var i = 0; i < adcs.length; i += 2) {

                            var name = adcs[i];
                            var champID = adcs[i + 1];
                            var champIcon = "https://ddragon.leagueoflegends.com/cdn/11.22.1/img/champion/" + name + ".png";
                            output += '<div class="col-sm"><img src="' + champIcon + '" alt="" class="img-fluid" onclick="championSelect(this)"id="' + champID + '"' + "><p>" + name + "</p></div>"

                            //output += '<a class="dropdown-item"' + 'id="' + champID + '" ' + 'onclick="championSelect(this)"' + '>' + name + '</a>';
                        }
                        document.getElementById("champList").innerHTML = output;
                    }
                })

            }


        </script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
            crossorigin="anonymous"></script>
        <script type="text/javascript" src="DataTables-1.11.3/js/jquery.dataTables.js"></script>
</body>
